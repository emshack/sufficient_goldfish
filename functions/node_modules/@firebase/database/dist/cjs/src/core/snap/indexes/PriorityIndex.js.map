{"version":3,"sources":["../src/core/snap/indexes/PriorityIndex.ts"],"names":[],"mappings":";AAAA;;;;;;;;;;;;;;GAcG;;;AAEH,iCAAgC;AAChC,wCAAwD;AACxD,gCAA0C;AAC1C,wCAAuC;AAEvC,IAAI,YAA8B,CAAC;AACnC,IAAI,QAAc,CAAC;AAEnB,yBAAgC,GAAqB;IACnD,YAAY,GAAG,GAAG,CAAC;AACrB,CAAC;AAFD,0CAEC;AAED,oBAA2B,GAAS;IAClC,QAAQ,GAAG,GAAG,CAAC;AACjB,CAAC;AAFD,gCAEC;AAED;;;;GAIG;AACH;IAAmC,yCAAK;IAAxC;;IA2DA,CAAC;IA1DC;;OAEG;IACH,+BAAO,GAAP,UAAQ,CAAY,EAAE,CAAY;QAChC,IAAM,SAAS,GAAG,CAAC,CAAC,IAAI,CAAC,WAAW,EAAE,CAAC;QACvC,IAAM,SAAS,GAAG,CAAC,CAAC,IAAI,CAAC,WAAW,EAAE,CAAC;QACvC,IAAM,QAAQ,GAAG,SAAS,CAAC,SAAS,CAAC,SAAS,CAAC,CAAC;QAChD,EAAE,CAAC,CAAC,QAAQ,KAAK,CAAC,CAAC,CAAC,CAAC;YACnB,MAAM,CAAC,kBAAW,CAAC,CAAC,CAAC,IAAI,EAAE,CAAC,CAAC,IAAI,CAAC,CAAC;QACrC,CAAC;QAAC,IAAI,CAAC,CAAC;YACN,MAAM,CAAC,QAAQ,CAAC;QAClB,CAAC;IACH,CAAC;IAED;;OAEG;IACH,mCAAW,GAAX,UAAY,IAAU;QACpB,MAAM,CAAC,CAAC,IAAI,CAAC,WAAW,EAAE,CAAC,OAAO,EAAE,CAAC;IACvC,CAAC;IAED;;OAEG;IACH,2CAAmB,GAAnB,UAAoB,OAAa,EAAE,OAAa;QAC9C,MAAM,CAAC,CAAC,OAAO,CAAC,WAAW,EAAE,CAAC,MAAM,CAAC,OAAO,CAAC,WAAW,EAAE,CAAC,CAAC;IAC9D,CAAC;IAED;;OAEG;IACH,+BAAO,GAAP;QACE,MAAM,CAAE,gBAAiB,CAAC,GAAG,CAAC;IAChC,CAAC;IAED;;OAEG;IACH,+BAAO,GAAP;QACE,MAAM,CAAC,IAAI,gBAAS,CAAC,eAAQ,EAAE,IAAI,mBAAQ,CAAC,iBAAiB,EAAE,QAAQ,CAAC,CAAC,CAAC;IAC5E,CAAC;IAED;;;;OAIG;IACH,gCAAQ,GAAR,UAAS,UAAe,EAAE,IAAY;QACpC,IAAM,YAAY,GAAG,YAAY,CAAC,UAAU,CAAC,CAAC;QAC9C,MAAM,CAAC,IAAI,gBAAS,CAAC,IAAI,EAAE,IAAI,mBAAQ,CAAC,iBAAiB,EAAE,YAAY,CAAC,CAAC,CAAC;IAC5E,CAAC;IAED;;OAEG;IACH,gCAAQ,GAAR;QACE,MAAM,CAAC,WAAW,CAAC;IACrB,CAAC;IACH,oBAAC;AAAD,CA3DA,AA2DC,CA3DkC,aAAK,GA2DvC;AA3DY,sCAAa;AA6Db,QAAA,cAAc,GAAG,IAAI,aAAa,EAAE,CAAC","file":"PriorityIndex.js","sourcesContent":["/**\n * Copyright 2017 Google Inc.\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { Index } from './Index';\nimport { nameCompare, MAX_NAME } from '../../util/util';\nimport { NamedNode, Node } from '../Node';\nimport { LeafNode } from '../LeafNode';\n\nlet nodeFromJSON: (a: any) => Node;\nlet MAX_NODE: Node;\n\nexport function setNodeFromJSON(val: (a: any) => Node) {\n  nodeFromJSON = val;\n}\n\nexport function setMaxNode(val: Node) {\n  MAX_NODE = val;\n}\n\n/**\n * @constructor\n * @extends {Index}\n * @private\n */\nexport class PriorityIndex extends Index {\n  /**\n   * @inheritDoc\n   */\n  compare(a: NamedNode, b: NamedNode): number {\n    const aPriority = a.node.getPriority();\n    const bPriority = b.node.getPriority();\n    const indexCmp = aPriority.compareTo(bPriority);\n    if (indexCmp === 0) {\n      return nameCompare(a.name, b.name);\n    } else {\n      return indexCmp;\n    }\n  }\n\n  /**\n   * @inheritDoc\n   */\n  isDefinedOn(node: Node): boolean {\n    return !node.getPriority().isEmpty();\n  }\n\n  /**\n   * @inheritDoc\n   */\n  indexedValueChanged(oldNode: Node, newNode: Node): boolean {\n    return !oldNode.getPriority().equals(newNode.getPriority());\n  }\n\n  /**\n   * @inheritDoc\n   */\n  minPost(): NamedNode {\n    return (NamedNode as any).MIN;\n  }\n\n  /**\n   * @inheritDoc\n   */\n  maxPost(): NamedNode {\n    return new NamedNode(MAX_NAME, new LeafNode('[PRIORITY-POST]', MAX_NODE));\n  }\n\n  /**\n   * @param {*} indexValue\n   * @param {string} name\n   * @return {!NamedNode}\n   */\n  makePost(indexValue: any, name: string): NamedNode {\n    const priorityNode = nodeFromJSON(indexValue);\n    return new NamedNode(name, new LeafNode('[PRIORITY-POST]', priorityNode));\n  }\n\n  /**\n   * @return {!string} String representation for inclusion in a query spec\n   */\n  toString(): string {\n    return '.priority';\n  }\n}\n\nexport const PRIORITY_INDEX = new PriorityIndex();\n"]}